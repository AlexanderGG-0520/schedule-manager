{% extends 'base.html' %}
{% block content %}
<div class="event-form">
  <h2>イベント編集</h2>
  <form method="post" novalidate>
    {{ form.hidden_tag() }}

    <div class="form-row">
      <label for="{{ form.title.id }}">タイトル</label>
      {{ form.title(class="input", size=60) }}
    </div>

    <div class="form-row">
      <label for="{{ form.description.id }}">詳細</label>
      {{ form.description(class="input", cols=60, rows=5) }}
    </div>

    <div class="form-row grid-two">
      <div>
        <label for="{{ form.start_at.id }}">開始日時</label>
        {{ form.start_at(class="input") }}
      </div>
      <div>
        <label for="{{ form.end_at.id }}">終了日時</label>
        {{ form.end_at(class="input") }}
      </div>
    </div>

    <div class="form-row">
      <label for="{{ form.location.id }}">場所</label>
      {{ form.location(class="input", size=60) }}
    </div>

    <div class="form-row">
      <label for="{{ form.participants.id }}">参加者</label>
      {{ form.participants(class="input", size=80) }}
      <div class="help-text">カンマ区切りで入力（例: alice@example.com, bob@example.com）</div>
    </div>

    <div class="form-row grid-three">
      <div>
        <label for="{{ form.category.id }}">カテゴリ</label>
        {{ form.category(class="input") }}
      </div>
      <div>
        <label for="{{ form.rrule.id }}">繰り返しルール</label>
        {{ form.rrule(class="input") }}
        <div class="help-text">例: FREQ=WEEKLY;BYDAY=MO,WE,FR</div>
      </div>
      <div>
        <label for="{{ form.timezone.id }}">タイムゾーン</label>
        {{ form.timezone(class="input") }}
        <div class="help-text">時刻はこのタイムゾーンで解釈されます</div>
      </div>
    </div>

    <div class="form-row grid-two">
      <div>
        <label for="{{ form.color.id }}">カラー</label>
        {{ form.color(type='color', class='color-input') }}
      </div>
      <div>
        <label for="{{ form.organization_id.id }}">所属</label>
        {{ form.organization_id(class='input') }}
      </div>
    </div>

    <div class="form-row form-actions">
      <button type="submit" class="btn primary">更新</button>
      <a href="{{ url_for('events.calendar') }}" class="btn">キャンセル</a>
    </div>
  </form>
  
  <form method="post" action="{{ url_for('events.delete_event', event_id=event.id) }}" style="margin-top: 1rem;" onsubmit="return confirm('このイベントを削除しますか？');">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
    <button type="submit" class="btn" style="background-color: #dc3545; color: white;">削除</button>
  </form>
</div>
{% endblock %}
